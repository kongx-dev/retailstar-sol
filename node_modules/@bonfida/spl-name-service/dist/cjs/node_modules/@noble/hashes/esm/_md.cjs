"use strict";var t=require("./utils.cjs");function s(t,s,e,i){if("function"==typeof t.setBigUint64)return t.setBigUint64(s,e,i);const n=BigInt(32),r=BigInt(4294967295),o=Number(e>>n&r),h=Number(e&r),u=i?4:0,f=i?0:4;t.setUint32(s+u,o,i),t.setUint32(s+f,h,i)}class e extends t.Hash{constructor(s,e,i,n){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=s,this.outputLen=e,this.padOffset=i,this.isLE=n,this.buffer=new Uint8Array(s),this.view=t.createView(this.buffer)}update(s){t.aexists(this),s=t.toBytes(s),t.abytes(s);const{view:e,buffer:i,blockLen:n}=this,r=s.length;for(let o=0;o<r;){const h=Math.min(n-this.pos,r-o);if(h!==n)i.set(s.subarray(o,o+h),this.pos),this.pos+=h,o+=h,this.pos===n&&(this.process(e,0),this.pos=0);else{const e=t.createView(s);for(;n<=r-o;o+=n)this.process(e,o)}}return this.length+=s.length,this.roundClean(),this}digestInto(e){t.aexists(this),t.aoutput(e,this),this.finished=!0;const{buffer:i,view:n,blockLen:r,isLE:o}=this;let{pos:h}=this;i[h++]=128,t.clean(this.buffer.subarray(h)),this.padOffset>r-h&&(this.process(n,0),h=0);for(let t=h;t<r;t++)i[t]=0;s(n,r-8,BigInt(8*this.length),o),this.process(n,0);const u=t.createView(e),f=this.outputLen;if(f%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const c=f/4,a=this.get();if(c>a.length)throw new Error("_sha2: outputLen bigger than state");for(let t=0;t<c;t++)u.setUint32(4*t,a[t],o)}digest(){const{buffer:t,outputLen:s}=this;this.digestInto(t);const e=t.slice(0,s);return this.destroy(),e}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:s,buffer:e,length:i,finished:n,destroyed:r,pos:o}=this;return t.destroyed=r,t.finished=n,t.length=i,t.pos=o,i%s&&t.buffer.set(e),t}clone(){return this._cloneInto()}}const i=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),n=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]);exports.Chi=function(t,s,e){return t&s^~t&e},exports.HashMD=e,exports.Maj=function(t,s,e){return t&s^t&e^s&e},exports.SHA256_IV=i,exports.SHA512_IV=n,exports.setBigUint64=s;
//# sourceMappingURL=_md.cjs.map
